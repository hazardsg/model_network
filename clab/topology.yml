---
# -------------------------------------------------------------
# Arista Network Topology
# 
# -------------------------------------------------------------

#https://containerlab.dev/manual/topo-def-file/#name
name: network_model

#https://containerlab.dev/manual/topo-def-file/#prefix
prefix: ""

#https://containerlab.dev/manual/network/#configuring-management-network
mgmt:
  network: mgmt
  ipv4-subnet: 172.100.100.0/24

#https://containerlab.dev/manual/topo-def-file/#topology
topology:

  defaults:
    env:
      INTFTYPE: et

  kinds:
    ceos:
      image: ceos:4.29.1F

  nodes:

###########################################
# Graphite Node                           #
# Provides Topology Graphing and the      #
# ability to connect to nodes in the      #
# topology via a web/ssh session          #
###########################################

    graphite:
      kind: linux
      image: netreplica/graphite
      mgmt-ipv4: 172.100.100.10
      env:
        HOST_CONNECTION: ${SSH_CONNECTION}
      binds:
        - __clabDir__/topology-data.json:/htdocs/default/default.json:ro
        - __clabDir__/ansible-inventory.yml:/htdocs/lab/default/ansible-inventory.yml:ro
      ports:
        - 80:80
      exec:
        - sh -c 'graphite_motd.sh 80'
      labels:
        graph-hide: yes

##############################
# Nodes generated by Script  #
##############################

#https://containerlab.dev/manual/topo-def-file/#nodes

    SPINE1_001c738697e7:
      kind: ceos
      mgmt-ipv4: 172.100.100.11
      startup-config: configs/SPINE1_001c738697e7.cfg
      binds:
        - override_configs/SPINE1_001c738697e7.cfg:/mnt/flash/SPINE1_001c738697e7.cfg:ro
      ports:
        - '12011:22'
        - '18011:80'
        - '14011:443'
      exec:
        - Cli -p 15 -c 'copy SPINE1_001c738697e7.cfg running-config'
        - Cli -p 15 -c 'write memory'
      labels:
        graph-level: 1
        graph-icon: switch

    SPINE2_001c73fd79ee:
      kind: ceos
      mgmt-ipv4: 172.100.100.12
      startup-config: configs/SPINE2_001c73fd79ee.cfg
      binds:
        - override_configs/SPINE2_001c73fd79ee.cfg:/mnt/flash/SPINE2_001c73fd79ee.cfg:ro
      ports:
        - '12012:22'
        - '18012:80'
        - '14012:443'
      exec:
        - Cli -p 15 -c 'copy SPINE2_001c73fd79ee.cfg running-config'
        - Cli -p 15 -c 'write memory'
      labels:
        graph-level: 1
        graph-icon: switch

    LEAF1_001c73ccf2d3:
      kind: ceos
      mgmt-ipv4: 172.100.100.13
      startup-config: configs/LEAF1_001c73ccf2d3.cfg
      binds:
        - override_configs/LEAF1_001c73ccf2d3.cfg:/mnt/flash/LEAF1_001c73ccf2d3.cfg:ro
      ports:
        - '12013:22'
        - '18013:80'
        - '14013:443'
      exec:
        - Cli -p 15 -c 'copy LEAF1_001c73ccf2d3.cfg running-config'
        - Cli -p 15 -c 'write memory'
      labels:
        graph-level: 1
        graph-icon: switch

    LEAF2_001c7331e5ff:
      kind: ceos
      mgmt-ipv4: 172.100.100.14
      startup-config: configs/LEAF2_001c7331e5ff.cfg
      binds:
        - override_configs/LEAF2_001c7331e5ff.cfg:/mnt/flash/LEAF2_001c7331e5ff.cfg:ro
      ports:
        - '12014:22'
        - '18014:80'
        - '14014:443'
      exec:
        - Cli -p 15 -c 'copy LEAF2_001c7331e5ff.cfg running-config'
        - Cli -p 15 -c 'write memory'
      labels:
        graph-level: 1
        graph-icon: switch

    LEAF3_001c73717c15:
      kind: ceos
      mgmt-ipv4: 172.100.100.15
      startup-config: configs/LEAF3_001c73717c15.cfg
      binds:
        - override_configs/LEAF3_001c73717c15.cfg:/mnt/flash/LEAF3_001c73717c15.cfg:ro
      ports:
        - '12015:22'
        - '18015:80'
        - '14015:443'
      exec:
        - Cli -p 15 -c 'copy LEAF3_001c73717c15.cfg running-config'
        - Cli -p 15 -c 'write memory'
      labels:
        graph-level: 1
        graph-icon: switch

    LEAF4_001c738f6441:
      kind: ceos
      mgmt-ipv4: 172.100.100.16
      startup-config: configs/LEAF4_001c738f6441.cfg
      binds:
        - override_configs/LEAF4_001c738f6441.cfg:/mnt/flash/LEAF4_001c738f6441.cfg:ro
      ports:
        - '12016:22'
        - '18016:80'
        - '14016:443'
      exec:
        - Cli -p 15 -c 'copy LEAF4_001c738f6441.cfg running-config'
        - Cli -p 15 -c 'write memory'
      labels:
        graph-level: 1
        graph-icon: switch



#https://containerlab.dev/manual/topo-def-file/#links
  links:

###############################
# Links Generated by Script   #
###############################

    - endpoints: ["LEAF2_001c7331e5ff:et1", "SPINE1_001c738697e7:et2"]

    - endpoints: ["LEAF3_001c73717c15:et4", "LEAF4_001c738f6441:et4"]

    - endpoints: ["LEAF2_001c7331e5ff:et2", "SPINE2_001c73fd79ee:et2"]

    - endpoints: ["LEAF4_001c738f6441:et1", "SPINE1_001c738697e7:et4"]

    - endpoints: ["LEAF3_001c73717c15:et2", "SPINE2_001c73fd79ee:et3"]

    - endpoints: ["SPINE1_001c738697e7:et6", "SPINE2_001c73fd79ee:et6"]

    - endpoints: ["LEAF1_001c73ccf2d3:et4", "LEAF2_001c7331e5ff:et4"]

    - endpoints: ["LEAF1_001c73ccf2d3:et3", "LEAF2_001c7331e5ff:et3"]

    - endpoints: ["LEAF3_001c73717c15:et3", "LEAF4_001c738f6441:et3"]

    - endpoints: ["LEAF1_001c73ccf2d3:et2", "SPINE2_001c73fd79ee:et1"]

    - endpoints: ["LEAF3_001c73717c15:et1", "SPINE1_001c738697e7:et3"]

    - endpoints: ["LEAF1_001c73ccf2d3:et1", "SPINE1_001c738697e7:et1"]

    - endpoints: ["LEAF4_001c738f6441:et2", "SPINE2_001c73fd79ee:et4"]

    - endpoints: ["SPINE1_001c738697e7:et5", "SPINE2_001c73fd79ee:et5"]
